# Инструкция по запуску

## Запуск FastAPI сервера

```bash
cd backend
python -m uvicorn app.main:app --reload
```

Сервер запустится на http://localhost:8000

---

## Запуск Telegram ботов

### Бот специалиста (для записей и отзывов)
```bash
cd backend
python bot_polling.py
```

### Бот разработчика (для отладки + уведомления об ошибках)
```bash
cd backend
python bot_polling.py --dev
```

---

## Важно: Дублирование сообщений

Если сообщения в боте начали дублироваться, это значит что запущено несколько экземпляров polling для одного бота.

### Решение:

1. Остановите все процессы Python:
   ```bash
   # Windows
   taskkill /F /IM python.exe

   # Или через диспетчер задач
   ```

2. Запустите только один экземпляр бота:
   ```bash
   python bot_polling.py
   ```

### Почему это происходит?

Telegram отправляет обновления всем активным polling-соединениям. Если запущено 2 экземпляра бота, каждый получит и обработает одно и то же обновление — отсюда дубли.

---

## Структура ботов

| Бот | Токен | Назначение |
|-----|-------|------------|
| Специалист | `TELEGRAM_SALON_BOT_TOKEN` | Записи клиентов, модерация отзывов |
| Разработчик | `TELEGRAM_BOT_TOKEN` | Те же функции + уведомления об ошибках системы |

---

## Команды ботов

- `/start` — Меню команд
- `/today` — Записи на сегодня
- `/tomorrow` — Записи на завтра
- `/week` — Записи на неделю
- `/slots` — Свободные слоты
- `/add` — Записать клиента вручную
- `/reviews` — Отзывы на модерации
- `/myschedule` — Расписание мастера
- `/block` — Заблокировать слот
- `/unblock` — Разблокировать слот
- `/services` — Список услуг
- `/edit` — Редактировать услугу
